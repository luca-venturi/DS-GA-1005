modify to take into account non-binary variables
